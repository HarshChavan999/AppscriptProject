<!-- heth -->


<!-- <div class="flex items-center justify-center bg-gray-100 p-4">
  <form id="feeReceiptForm" class="receipt-form-container" onsubmit="FeeReceiptFormHandle(event)">
    <div class="form-wrapper">
      <div class="form-card">
        <div class="form-header">
          <div class="header-main-content">
            <div class="header-logo-title">
              <div class="logo-container"
                style="width: 180px; height: auto; display: flex; justify-content: center; align-items: center;">
                <img
                                    src="https://i.postimg.cc/FzvwbhS3/Untitled-1.png"
                                    alt="Logo"
                                    style="width: 100%; max-width: 160px; height: auto; padding: 5px;"
                                />
              </div>
            </div>
            <div class="header-contact-info">
              <p class="receipt-label">
                <i class="fas fa-file-invoice-dollar"></i> EXAM RECEIPT
              </p>
            </div>
          </div>
        </div>

        <div class="form-body">
          <div id="FeeReceiptForm" class="form-fields-grid">
            <div class="form-row">
              <div>
                <label for="receiptDate" class="form-label"><i class="fas fa-calendar-alt"></i>Date</label>
                <input type="date" id="receiptDate" name="receiptDate" required class="form-input">
              </div>
              <div>
                <label for="ExamReceiptNumber" class="form-label"><i class="fas fa-hashtag"></i>Receipt No</label>
                <input type="text" id="ExamReceiptNumber" name="receiptNumber" required class="form-input">
              </div>
            </div>

            <div class="form-row">
              <div>
                <label for="studentName" class="form-label"><i class="fas fa-user-graduate"></i>Student Name</label>
                <input type="text" id="studentName" name="studentName" required class="form-input">
              </div>
              <div>
                <label for="courseName" class="form-label"><i class="fas fa-book"></i>Course Name</label>
                <input type="text" id="courseName" name="courseName" required class="form-input">
              </div>
            </div>

            <div class="payment-info-box">
              <h3 class="payment-info-title">
                <i class="fas fa-money-bill-wave"></i>Payment Information
              </h3>
              <div class="payment-info-grid">
                <div>
                  <label for="totalAmount" class="form-label">Total Amount (₹)</label>
                  <input type="number" id="totalAmount" name="totalAmount" value="500" required class="form-input" readonly>
                </div>

                <div>
                                    <label for="paidAmount" class="form-label">Amount Paid (₹)</label>
                                    <input type="number" id="paidAmount" name="paidAmount" required class="form-input">
                                </div>
                                <div>
                                    <label for="balanceAmount" class="form-label">Balance Amount (₹)</label>
                                    <input type="number" id="balanceAmount" name="balanceAmount" readonly class="form-input">
                                </div>
              </div>
            </div>

            <div class="form-row">
              <div>
                <label for="paymentMode" class="form-label"><i class="fas fa-credit-card"></i>Payment Mode</label>
                <select id="paymentMode" name="paymentMode" required class="form-select">
                                    <option value="" disabled selected>Select Payment Mode</option>
                                    <option value="Cash">Cash</option>
                                    <option value="Cheque">Cheque</option>
                                    <!-- <option value="Bank Transfer">Bank Transfer</option> -->
                                    <!-- <option value="UPI">UPI</option>
                                    <option value="Credit/Debit Card">Credit/Debit Card</option>
                                </select>
              </div>
              <div>
                                <label for="transactionDetails" class="form-label"><i class="fas fa-info-circle"></i>Transaction Details</label>
                                <input type="text" id="transactionDetails" name="transactionDetails" class="form-input" placeholder="Cheque/UTR/UPI ID">
                            </div>
            </div>

             <div class="form-row">
              <div>
                <label for="receivedBy" class="form-label"><i class="fas fa-user-tie"></i>Received By</label>
                <input type="text" id="receivedBy" name="receivedBy" required class="form-input">
              </div>
              <div>
                <label for="branch" class="form-label"><i class="fas fa-building"></i>Branch</label>
                <input type="text" id="branch" name="branch" required class="form-input">
              </div>
            </div>

            <div class="terms-section">
              <h3 class="terms-title">
                <i class="fas fa-exclamation-circle"></i>Terms & Conditions
              </h3>
              <ul class="terms-list">
                <li>Fees once paid are non-refundable and non-transferable.</li>
                <li>Original receipt must be produced for any fee-related queries.</li>
                <li>Installments must be paid before the due date.</li>
                <li>Certificate will be issued only after full payment of fees.</li>
              </ul>
            </div>

            <div class="form-footer">
              <div class="footer-actions">
                <div class="terms-checkbox">
                  <label>
                                        <input type="checkbox" id="agreeTerms" name="agreeTerms" required>
                                        <span>I acknowledge the above payment details</span>
                                    </label>
                  <div id="agreeError" class="error-message"></div>
                </div>

                <div class="flex justify-end space-x-4">
                  <button type="button" onclick="generatePDFReceipt()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-medium">
                                        <i class="fas fa-file-pdf mr-2"></i>Download PDF
                                    </button> 
                  <button onclick="generateexamReceipt()"
 class="bg-gradient-to-r from-blue-600 to-indigo-700 hover:from-blue-700 hover:to-indigo-800 text-white font-medium tracking-wide py-2.5 px-6 rounded-md shadow-lg transform hover:scale-105 transition duration-300 flex items-center justify-center gap-2"
      >Save & Generate Receipt</button>

                  <button type="submit" id="submitReceipt" class="submit-btn text-blue-600 px-8 py-2 rounded-lg font-medium">
                                        <i class="fas fa-save mr-2"></i>Save Receipt
                                    </button>
                </div>
              </div>
            </div>
          </div>
        </div> -->

        <!-- <div class="signature-section">
          <div class="signature-line-container">
            <div class="signature-line">______________________</div>
            <div class="signature-title">AUTHORIZED SIGNATURE</div>
          </div>
        </div> -->
      <!-- </div>
    </div>
  </form>
</div> --> 

<!-- <div class="flex items-center justify-center bg-gray-100 p-4">
    <form id="feeReceiptForm" class="receipt-form-container" onsubmit="FeeReceiptFormHandle(event)">
        <div class="form-wrapper">
            <div class="form-card">
                <div class="form-header">
                    <div class="header-main-content">
                        <div class="header-logo-title">
                            <div class="logo-container" style="width: 180px; height: auto; display: flex; justify-content: center; align-items: center;">
                                <img 
                                    src="https://i.postimg.cc/FzvwbhS3/Untitled-1.png" 
                                    alt="Logo" 
                                    style="width: 100%; max-width: 160px; height: auto; padding: 5px;"
                                />
                            </div>
                        </div>
                        <div class="header-contact-info">
                            <p class="receipt-label">
                                <i class="fas fa-file-invoice-dollar"></i> FEE RECEIPT
                            </p>
                        </div>
                    </div>
                </div>

                <div class="form-body">
                    <div id="FeeReceiptForm" class="form-fields-grid">
                        <div class="form-row">
                            <div>
                                <label for="receiptDate" class="form-label"><i class="fas fa-calendar-alt"></i>Date</label>
                                <input type="date" id="receiptDate" name="receiptDate" required class="form-input">
                            </div>
                            <div>
                                <label for="ExamReceiptNumber" class="form-label"><i class="fas fa-hashtag"></i>Receipt No</label>
                                <input type="text" id="ExamReceiptNumber" name="receiptNumber" required class="form-input">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div>
                                <label for="studentNameInput" class="form-label"><i class="fas fa-user-graduate"></i>Student Name</label>
                                <input type="text" id="studentNameInput" name="studentName" required class="form-input">
                            </div>
                            <div>
                                <label for="courseNameInput" class="form-label"><i class="fas fa-book"></i>Course Name</label>
                                <input type="text" id="courseNameInput" name="courseName" required class="form-input">
                            </div>
                        </div>
                        
                        <div class="payment-info-box">
                            <h3 class="payment-info-title">
                                <i class="fas fa-money-bill-wave"></i>Payment Information
                            </h3>
                            <div class="payment-info-grid">
                                <div>
                                    <label for="totalAmount" class="form-label">Total Amount (₹)</label>
                                    <input type="number" id="totalAmount" name="totalAmount" value="500" class="form-input">
                                </div> -->
                                <!-- <div>
                                    <label for="paidAmount" class="form-label">Amount Paid (₹)</label>
                                    <input type="number" id="paidAmount" name="paidAmount" required class="form-input">
                                </div> -->
                                <!-- <div>
                                    <label for="balanceAmount" class="form-label">Balance Amount (₹)</label>
                                    <input type="number" id="balanceAmount" name="balanceAmount" readonly class="form-input">
                                </div> -->
                            <!-- </div>
                        </div>
                        
                        <div class="form-row">
                            <div>
                                <label for="paymentModeInput" class="form-label"><i class="fas fa-credit-card"></i>Payment Mode</label>
                                <select id="paymentModeInput" name="paymentMode" required class="form-select">
                                    <option value="" disabled selected>Select Payment Mode</option>
                                    <option value="Cash">Cash</option>
                                    <option value="Cheque">Cheque</option>
                                    <option value="Bank Transfer">Bank Transfer</option>
                                    <option value="UPI">UPI</option>
                                    <option value="Credit/Debit Card">Credit/Debit Card</option>
                                </select>
                            </div> -->
                            <!-- <div>
                                <label for="transactionDetails" class="form-label"><i class="fas fa-info-circle"></i>Transaction Details</label>
                                <input type="text" id="transactionDetails" name="transactionDetails" class="form-input" placeholder="Cheque/UTR/UPI ID">
                            </div> -->
                        <!-- </div>
                        
                        <div class="form-row"> -->
                            <!-- <div>
                                <label for="receivedBy" class="form-label"><i class="fas fa-user-tie"></i>Received By</label>
                                <input type="text" id="receivedBy" name="receivedBy" required class="form-input">
                            </div> -->
                            <!-- <div>
                                <label for="branch" class="form-label"><i class="fas fa-building"></i>Branch</label>
                                <input type="text" id="branch" name="branch" required class="form-input">
                            </div> -->
                        <!-- </div> -->
                        
                        <!-- <div class="terms-section">
                            <h3 class="terms-title">
                                <i class="fas fa-exclamation-circle"></i>Terms & Conditions
                            </h3>
                            <ul class="terms-list">
                                <li>Fees once paid are non-refundable and non-transferable.</li>
                                <li>Original receipt must be produced for any fee-related queries.</li>
                                <li>Installments must be paid before the due date.</li>
                                <li>Certificate will be issued only after full payment of fees.</li>
                            </ul>
                        </div> -->
                        
                        <!-- <div class="form-footer">
                            <div class="footer-actions">
                                <div class="terms-checkbox">
                                    <label>
                                        <input type="checkbox" id="agreeTerms" name="agreeTerms" required>
                                        <span>I acknowledge the above payment details</span>
                                    </label>
                                    <div id="agreeError" class="error-message"></div>
                                </div>
                                
                                <div class="flex justify-end space-x-4">
                                   <button type="button" onclick="generateexamReceipt()" class="bg-gradient-to-r from-blue-600 to-indigo-700 hover:from-blue-700 hover:to-indigo-800 text-white font-medium tracking-wide py-2.5 px-6 rounded-md shadow-lg transform hover:scale-105 transition duration-300 flex items-center justify-center gap-2">
    <i class="fas fa-receipt mr-2"></i>Generate Receipt
</button>

                                    <button type="submit" id="submitReceipt" class="submit-btn text-blue-600 px-8 py-2 rounded-lg font-medium">
                                        <i class="fas fa-save mr-2"></i>Save Receipt
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="signature-section">
                    <div class="signature-line-container">
                        <div class="signature-line">______________________</div>
                        <div class="signature-title">AUTHORIZED SIGNATURE</div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div> -->
<!-- <div class="flex items-center justify-center bg-gray-100 p-4">
    <form id="feeReceiptForm" class="receipt-form-container w-full max-w-4xl" onsubmit="FeeReceiptFormHandle(event)">
        <div class="form-wrapper bg-white rounded-lg shadow-md overflow-hidden">
            <div class="form-card p-6">
                <div class="form-header mb-6">
                    <div class="header-main-content flex flex-col md:flex-row items-center justify-between gap-4">
                        <div class="header-logo-title">
                            <div class="logo-container" style="width: 180px; height: auto;">
                                <img 
                                    src="https://i.postimg.cc/FzvwbhS3/Untitled-1.png" 
                                    alt="Logo" 
                                    class="w-full max-w-[160px] h-auto p-1"
                                />
                            </div>
                        </div>
                        <div class="header-contact-info">
                            <p class="receipt-label text-xl font-bold text-yellow-300">
                                <i class="fas fa-file-invoice-dollar mr-2"></i> FEE RECEIPT
                            </p>
                        </div>
                    </div>
                </div>

                <div class="form-body">
                    <div id="FeeReceiptForm" class="form-fields-grid space-y-6">
                        <div class="form-row grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="form-group">
                                <label for="receiptDate" class="form-label block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-calendar-alt mr-2"></i>Date
                                </label>
                                <input type="date" id="receiptDate" name="receiptDate" required class="form-input w-full p-2 border border-gray-300 rounded-md">
                            </div>
                            <div class="form-group">
                                <label for="ExamReceiptNumber" class="form-label block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-hashtag mr-2"></i>Receipt No
                                </label>
                                <input type="text" id="ExamReceiptNumber" name="receiptNumber" required class="form-input w-full p-2 border border-gray-300 rounded-md">
                            </div>
                        </div>
                        
                        <div class="form-row grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="form-group">
                                <label for="studentNameInput" class="form-label block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-user-graduate mr-2"></i>Student Name
                                </label>
                                <input type="text" id="studentNameInput" name="studentName" required class="form-input w-full p-2 border border-gray-300 rounded-md">
                            </div>
                            <div class="form-group">
                                <label for="courseNameInput" class="form-label block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-book mr-2"></i>Course Name
                                </label>
                                <input type="text" id="courseNameInput" name="courseName" required class="form-input w-full p-2 border border-gray-300 rounded-md">
                            </div>
                        </div>
                        
                       <div class="payment-info-box">
                            <h3 class="payment-info-title">
                                <i class="fas fa-money-bill-wave"></i> Payment Information
                            </h3>
                            <div class="payment-info-grid grid grid-cols-1 md:grid-cols-1 gap-4">
                                <div class="form-group">
                                    <label for="totalAmount" class="form-label block text-sm font-medium text-gray-700 mb-1">Total Amount (₹)</label>
                                    <input type="number" id="totalAmount" name="totalAmount" value="500" class="form-input w-full p-2 border border-gray-300 rounded-md">
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-row grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="form-group">
                                <label for="paymentModeInput" class="form-label block text-sm font-medium text-gray-700 mb-1">
                                    <i class="fas fa-credit-card mr-2"></i>Payment Mode
                                </label>
                                <select id="paymentModeInput" name="paymentMode" required class="form-select w-full p-2 border border-gray-300 rounded-md">
                                    <option value="" disabled selected>Select Payment Mode</option>
                                    <option value="Cash">Cash</option>
                                    <option value="Cheque">Cheque</option>
                                    <option value="Bank Transfer">Bank Transfer</option>
                                    <option value="UPI">UPI</option>
                                    <option value="Credit/Debit Card">Credit/Debit Card</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-footer mt-8">
                            <div class="footer-actions">
                                <div class="terms-checkbox mb-4">
                                    <label class="flex items-center">
                                        <input type="checkbox" id="agreeTerms" name="agreeTerms" required class="mr-2">
                                        <span class="text-sm text-gray-700">I acknowledge the above payment details</span>
                                    </label>
                                    <div id="agreeError" class="error-message text-red-500 text-xs mt-1"></div>
                                </div>
                                
                                <div class="flex flex-col sm:flex-row justify-end gap-4">
                                    <button type="button" onclick="generateexamReceipt()" class="bg-gradient-to-r from-blue-600 to-indigo-700 hover:from-blue-700 hover:to-indigo-800 text-white font-medium py-2.5 px-6 rounded-md shadow-lg hover:scale-105 transition duration-300 flex items-center justify-center">
                                        <i class="fas fa-receipt mr-2"></i>Generate Receipt
                                    </button>
                                    <button type="submit" id="submitReceipt" class="bg-white border border-blue-600 text-blue-600 hover:bg-blue-50 font-medium py-2.5 px-6 rounded-md shadow-lg hover:scale-105 transition duration-300 flex items-center justify-center">
                                        <i class="fas fa-save mr-2"></i>Save Receipt
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                
            </div>
        </div>
    </form>
</div> -->

<div class="flex items-center justify-center min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-4 hidden" id="feeReceiptForm">
    <div class="w-full max-w-5xl">
        <!-- Header Section -->
        <div class="bg-white rounded-t-xl shadow-lg overflow-hidden">
            <div class="bg-gradient-to-r from-blue-600 to-indigo-700 px-8 py-6">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <div class="flex-shrink-0">
                            <img src="https://i.postimg.cc/FzvwbhS3/Untitled-1.png"
                                 alt="Shelar Training Institute Logo"
                                 class="h-16 w-auto rounded-lg shadow-sm">
                        </div>
                        <div>
                            <h1 class="text-2xl font-bold text-white">SHELAR TRAINING INSTITUTE</h1>
                            <p class="text-blue-100 text-sm">Quality Education • Skill Development</p>
                        </div>
                    </div>
                    <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-lg px-6 py-3">
                        <p class="text-white font-semibold text-lg">
                            <i class="fas fa-receipt mr-2"></i>EXAM RECEIPT
                        </p>
                    </div>
                </div>
            </div>

            <form id="feeReceiptForm" class="p-8" onsubmit="FeeReceiptFormHandle(event)">
                <div id="FeeReceiptForm" class="space-y-8">

                    <!-- Invoice Details Section -->
                    <div class="bg-gray-50 rounded-xl p-6 border border-gray-200">
                        <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-file-invoice-dollar mr-2 text-blue-500"></i>Invoice Details
                        </h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

                            <!-- Date Field -->
                            <div class="space-y-2">
                                <label for="receiptDate" class="block text-sm font-medium text-gray-700 flex items-center">
                                    <i class="fas fa-calendar-alt mr-2 text-blue-500"></i>Date <span class="text-red-500 ml-1">*</span>
                                </label>
                                <div class="relative">
                                    <div id="receiptDateDisplay"
                                         style="width: 100%; padding: 0.75rem 3rem 0.75rem 1rem; border: 1px solid #d1d5db; border-radius: 0.5rem; background-color: #f9f9f9; color: #111827; font-size: 0.875rem; font-weight: 500; display: flex; align-items: center; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);">
                                        Loading...
                                    </div>
                                    <input type="hidden" id="receiptDate" name="receiptDate" value="">
                                    <i class="fas fa-calendar-alt absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                </div>
                            </div>

                            <!-- Receipt Number Field -->
                            <div class="space-y-2">
                                <label for="ExamReceiptNumber" class="block text-sm font-medium text-gray-700 flex items-center">
                                    <i class="fas fa-hashtag mr-2 text-blue-500"></i>Receipt Number <span class="text-red-500 ml-1">*</span>
                                </label>
                                <input type="text" id="ExamReceiptNumber" name="receiptNumber"
                                       style="width: 100%; padding: 0.75rem 1rem; border: 1px solid #d1d5db; border-radius: 0.5rem; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); background-color: white; color: #111827; font-size: 0.875rem; outline: none;"
                                       class="transition-colors duration-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                       readonly>
                            </div>

                            <!-- Student Name Field -->
                            <div class="space-y-2">
                                <label for="studentNameInput" class="block text-sm font-medium text-gray-700 flex items-center">
                                    <i class="fas fa-user-graduate mr-2 text-blue-500"></i>Student Name <span class="text-red-500 ml-1">*</span>
                                </label>
                                <input type="text" id="studentNameInput" name="studentName"
                                       style="width: 100%; padding: 0.75rem 1rem; border: 1px solid #d1d5db; border-radius: 0.5rem; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); background-color: white; color: #111827; font-size: 0.875rem; outline: none;"
                                       class="transition-colors duration-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                       required placeholder="Enter student name">
                            </div>

                            <!-- Course Name Field -->
                            <div class="space-y-2">
                                <label for="courseNameInput" class="block text-sm font-medium text-gray-700 flex items-center">
                                    <i class="fas fa-book mr-2 text-blue-500"></i>Course Name <span class="text-red-500 ml-1">*</span>
                                </label>
                                <input type="text" id="courseNameInput" name="courseName"
                                       style="width: 100%; padding: 0.75rem 1rem; border: 1px solid #d1d5db; border-radius: 0.5rem; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); background-color: white; color: #111827; font-size: 0.875rem; outline: none;"
                                       class="transition-colors duration-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                       required placeholder="Enter course name">
                            </div>
                        </div>
                    </div>

                    <!-- Payment Information Section -->
                    <div class="bg-white rounded-xl p-6 border border-gray-200 shadow-sm">
                        <h2 class="text-lg font-semibold text-gray-800 mb-6 flex items-center">
                            <i class="fas fa-money-bill-wave mr-2 text-green-500"></i>Payment Information
                        </h2>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Total Amount Field -->
                            <div class="space-y-2">
                                <label for="totalAmount" class="block text-sm font-medium text-gray-700 flex items-center">
                                    <i class="fas fa-rupee-sign mr-2 text-green-500"></i>Total Amount (₹) <span class="text-red-500 ml-1">*</span>
                                </label>
                                <input type="number" id="totalAmount" name="totalAmount" value="500"
                                       style="width: 100%; padding: 0.75rem 1rem; border: 1px solid #d1d5db; border-radius: 0.5rem; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); background-color: white; color: #111827; font-size: 0.875rem; font-weight: 600; outline: none;"
                                       class="transition-colors duration-200 focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            </div>

                            <!-- Payment Mode Field -->
                            <div class="space-y-2">
                                <label for="paymentModeInput" class="block text-sm font-medium text-gray-700 flex items-center">
                                    <i class="fas fa-credit-card mr-2 text-blue-500"></i>Payment Mode <span class="text-red-500 ml-1">*</span>
                                </label>
                                <select id="paymentModeInput" name="paymentMode"
                                        style="width: 100%; padding: 0.75rem 1rem; border: 1px solid #d1d5db; border-radius: 0.5rem; box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); background-color: white; color: #111827; font-size: 0.875rem; outline: none;"
                                        class="transition-colors duration-200 focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                        required>
                                    <option value="" disabled selected>Select Payment Mode</option>
                                    <option value="Cash">💵 Cash</option>
                                    <option value="Cheque">📝 Cheque</option>
                                    <option value="Bank Transfer">🏦 Bank Transfer</option>
                                    <option value="UPI">📱 UPI</option>
                                    <option value="Credit/Debit Card">💳 Credit/Debit Card</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Terms and Actions Section -->
                    <div class="bg-green-50 rounded-xl p-6 border border-green-200">
                        <div class="flex items-start space-x-3 mb-6">
                            <input type="checkbox" id="agreeTerms" name="agreeTerms"
                                   class="h-5 w-5 text-green-600 focus:ring-green-500 border-gray-300 rounded mt-0.5"
                                   required>
                            <div class="flex-1">
                                <label for="agreeTerms" class="text-sm font-medium text-gray-700 cursor-pointer">
                                    I acknowledge and agree to the payment details above
                                </label>
                                <p class="text-xs text-gray-600 mt-1">
                                    By checking this box, I confirm that all payment information is accurate and complete.
                                </p>
                            </div>
                        </div>
                        <div id="agreeError" class="text-red-600 text-sm font-medium mb-4 hidden">
                            Please accept the terms and conditions to proceed.
                        </div>

                        <!-- Action Buttons -->
                        <div class="flex flex-col sm:flex-row gap-4 justify-end">
                            <button type="button" onclick="generateexamReceipt()"
                                    class="bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold py-3 px-8 rounded-lg shadow-lg transform hover:scale-105 transition-all duration-200 flex items-center justify-center gap-2 w-full sm:w-auto">
                                <i class="fas fa-print"></i>
                                Generate Receipt
                            </button>

                            <button type="submit" id="submitReceipt"
                                    class="bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-semibold py-3 px-8 rounded-lg shadow-lg transform hover:scale-105 transition-all duration-200 flex items-center justify-center gap-2 w-full sm:w-auto">
                                <i class="fas fa-save"></i>
                                Save Receipt
                            </button>
                        </div>
                    </div>

                </div>
            </form>
        </div>

        <!-- Footer -->
        <div class="bg-gray-800 text-white text-center py-4 rounded-b-xl">
            <p class="text-sm opacity-75">© 2025 Shelar Training Institute. All rights reserved.</p>
        </div>
    </div>
</div>

<script>
  // Calculate balance amount automatically
    // document.getElementById('paidAmount').addEventListener('input', function() {
    //     const total = parseFloat(document.getElementById('totalAmount').value) || 0;
    //     const paid = parseFloat(this.value) || 0;
    //     const balance = total - paid;
    //     document.getElementById('balanceAmount').value = balance.toFixed(2);
    // });
    
    // Handle form submission
    function FeeReceiptFormHandle(e) {
  e.preventDefault();

  const form = document.getElementById('feeReceiptForm');
  const formData = new FormData(form);

  const data = {
    receiptDate: formData.get('receiptDate'),
    receiptNumber: formData.get('ExamReceiptNumber'),
    studentName: formData.get('studentName'),
    courseName: formData.get('courseName'),
    totalAmount: formData.get('totalAmount'),
    paymentMode: formData.get('paymentMode'),
    // receivedBy: formData.get('receivedBy'),
    // branch: formData.get('branch'),
    agreeTerms: formData.get('agreeTerms') ? 'Yes' : 'No'
  };

  google.script.run.withSuccessHandler(() => {
    alert("Receipt saved successfully!");
    form.reset();
  }).saveReceiptData(data);
}

    
    // Generate PDF receipt
    function generatePDFReceipt() {
        // Add your PDF generation logic here
        console.log("Generating PDF receipt");
    }
function openexamfees() {
    console.log("openexamfees() called - starting form setup");
    hideAllSections();
    const formShown = document.getElementById("feeReceiptForm").classList.remove("hidden");
    console.log("Form shown:", formShown);

    copyadmissionreceipt();
    console.log("copyadmissionreceipt() completed");

    loadexamfee();
    console.log("loadexamfee() completed");

    // Auto-populate today's date in the date field - Format DD/MM/YYYY for display
    console.log("About to set date in exam fees form...");

    // Wait for all other functions to complete, then set the date
    setTimeout(() => {
        console.log("Setting date now...");
        const dateInput = document.getElementById('receiptDate');
        const isFormVisible = !document.getElementById("feeReceiptForm").classList.contains("hidden");

        console.log("Date input found:", !!dateInput);
        console.log("Form is visible:", isFormVisible);

        if (dateInput && isFormVisible) {
            const today = new Date();
            const yyyy = today.getFullYear();
            const mm = String(today.getMonth() + 1).padStart(2, '0');
            const dd = String(today.getDate()).padStart(2, '0');
            const displayDate = `${dd}/${mm}/${yyyy}`;

            console.log("Setting value to:", displayDate);

            // Set the hidden form field (for form submission)
            dateInput.value = displayDate;

            // Set the visible display field (what the user sees)
            const displayField = document.getElementById('receiptDateDisplay');
            if (displayField) {
                displayField.textContent = displayDate;
                console.log("Display field updated to:", displayDate);
            } else {
                console.log("Display field not found!");
            }

            console.log("Hidden input value set to:", dateInput.value);
            console.log("Parent container hidden:", document.getElementById("feeReceiptForm").classList.contains("hidden"));
        } else {
            console.log("Date input not found or form not visible!");
            console.log("Date input element:", dateInput);
            console.log("Form visibility:", isFormVisible);
        }
    }, 500); // Increased delay to 500ms
   
  //   // 1. Get the stored branch from the hidden input
  //   const userBranch = document.getElementById("userBranch").value;

  //   // 2. Get the branch input element in your inquiry form
  //   const branchInput = document.getElementById("branch");

  //   // 3. Set its value directly
  //   if (userBranch) {
  //       branchInput.value = userBranch;
  //   } else {
  //       branchInput.value = ""; // Or some default value
  //   }

  //   // ⭐ START: Add this section for Inquiry Taken By
  //   // 4. Get the stored username from the hidden input (loggedInUserId)
  //   const loggedInUser = document.getElementById("loggedInUserId").value; // Or document.getElementById("userName").value;

  //   // 5. Get the Inquiry Taken By input element
  //   const inquiryTakenByInput = document.getElementById("receivedBy");

  //   // 6. Set its value directly
  //   if (loggedInUser) {
  //       inquiryTakenByInput.value = loggedInUser;
  //   } else {
  //       inquiryTakenByInput.value = ""; // Or some default value like "Anonymous"
  //   }
  }

//   function examfeeTakenBy() {
//     const inquiryTakenByInput = document.getElementById("receivedBy");
//     const branchInput = document.getElementById("branch"); // Get the branch input

//     // Get the logged-in username from the hidden input field that was set during login
//     const loggedInUserFromHiddenInput = document.getElementById("loggedInUserId")?.value;
//     // Get the logged-in branch from the hidden input field that was set during login
//     const loggedInBranchFromHiddenInput = document.getElementById("userBranch")?.value;


//     if (inquiryTakenByInput) {
//         if (loggedInUserFromHiddenInput) {
//             inquiryTakenByInput.value = loggedInUserFromHiddenInput;
//             inquiryTakenByInput.readOnly = true; // Ensure it's readonly
//         } else {
//             inquiryTakenByInput.value = "N/A"; // Or handle anonymous users differently
//             console.warn("Logged-in user ID not found in hidden input.");
//         }
//     }

//     if (branchInput) {
//         if (loggedInBranchFromHiddenInput) {
//             branchInput.value = loggedInBranchFromHiddenInput;
//             branchInput.readOnly = true; // Ensure it's readonly
//         } else {
//             branchInput.value = "N/A"; // Or some default
//             console.warn("Logged-in user branch not found in hidden input.");
//         }
//     }
// }

function generateexamReceipt() {
    try {
        // Get values from the form
        const receiptNo = document.getElementById('ExamReceiptNumber').value || "REC" + Math.floor(1000 + Math.random() * 9000);
        const date = document.getElementById('receiptDate').value || new Date().toLocaleDateString('en-GB');
        const studentName = document.getElementById('studentNameInput').value || "N/A";
        const courseName = document.getElementById('courseNameInput').value || "N/A";
        const totalAmount = parseFloat(document.getElementById('totalAmount').value) || 0;
        // const paidAmount = parseFloat(document.getElementById('paidAmount').value) || 0;
        // const balanceAmount = totalAmount - paidAmount;
        // const receivedBy = document.getElementById('receivedBy').value || "Admin";
        const paymentMode = document.getElementById('paymentModeInput').value || "Cash";
        // const transactionDetails = document.getElementById('transactionDetails').value || "-";

        // Format currency
        const formatCurrency = (amount) => {
            return '₹' + amount.toFixed(2);
        };

        // Prepare receipt data
        const receiptData = {
            receiptNo: receiptNo,
            date: date,
            studentName: studentName,
            courseName: courseName,
            totalAmount: formatCurrency(totalAmount),
            // paidAmount: formatCurrency(paidAmount),
            // balanceAmount: formatCurrency(balanceAmount),
            paymentMode: paymentMode,
            // transactionDetails: transactionDetails,
            // receivedBy: receivedBy
        };

        // Generate the receipt HTML
        const receiptHTML = `
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Receipt</title>
                <style>
                    @page { size: A4; margin: 0.5in; }
                    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: white; }
                    .page-container { width: 210mm; height: 297mm; display: flex; flex-direction: column; 
                                    justify-content: space-between; padding: 10mm; box-sizing: border-box; }
                    .receipt { width: 100%; height: 45%; border: 3px solid #000; border-radius: 15px; 
                             padding: 15px; box-sizing: border-box; background: white; margin-bottom: 10mm; 
                             page-break-inside: avoid; }
                    .header { display: flex; align-items: center; margin-bottom: 15px; 
                             border-bottom: 2px solid #000; padding-bottom: 10px; }
                    .logo { width: 60px; height: 60px; margin-right: 15px; display: flex; 
                           align-items: center; justify-content: center; overflow: hidden; }
                    .logo img { width: 100%; height: auto; object-fit: contain; display: block; }
                    .institute-name { font-size: 28px; font-weight: bold; color: #000; 
                                    flex-grow: 1; letter-spacing: 1px; }
                    .receipt-label { background: #333; color: white; padding: 5px 15px; 
                                    border-radius: 20px; font-size: 14px; font-weight: bold; }
                    .receipt-content { display: flex; flex-direction: column; height: calc(100% - 100px); }
                    .receipt-info { display: flex; justify-content: space-between; margin-bottom: 20px; }
                    .receipt-no, .date { font-size: 16px; font-weight: bold; }
                    .form-fields { flex-grow: 1; display: flex; flex-direction: column; gap: 12px; }
                    .field-row { display: flex; align-items: center; font-size: 14px; font-weight: bold; }
                    .field-label { min-width: 140px; color: #000; }
                    .field-value { flex-grow: 1; border-bottom: 1px solid #000; padding: 2px 5px; 
                                 min-height: 20px; color: #0066cc; white-space: nowrap; 
                                 overflow: hidden; text-overflow: ellipsis; max-width: calc(100% - 140px); }
                    .amount-fields { display: flex; gap: 20px; }
                    .amount-field { flex: 1; min-width: 30%; }
                    .amount-fields .field-value { max-width: none; white-space: normal; word-break: break-all; flex-grow: 1; }
                    .amount-fields .field-label { min-width: 80px; }
                    .footer { margin-top: 15px; display: flex; justify-content: space-between; align-items: flex-end; }
                    .note { font-size: 12px; font-weight: bold; max-width: 60%; }
                    .signature-area { text-align: center; min-width: 150px; }
                    .signature-line { border-bottom: 1px solid #000; height: 40px; margin-bottom: 5px; }
                    .signature-label { font-size: 12px; font-weight: bold; }
                    @media print { 
                        .page-container { height: 297mm; padding: 0.5in; } 
                        .receipt { margin-bottom: 5mm; } 
                    }
                </style>
            </head>
            <body>
                <div class="page-container">
                    <!-- First Receipt -->
                    <div class="receipt">
                        <div class="header">
                            <div class="logo">
                                <img src="data:image/svg+xml;utf8,
<svg xmlns='http://www.w3.org/2000/svg' width='160' height='160'>
  <circle cx='80' cy='80' r='75' fill='%232c3e50'/>
  <text x='50%' y='55%' font-size='80' font-family='Arial' font-weight='bold' fill='white' text-anchor='middle' dominant-baseline='middle'>S</text>
</svg>"
alt="Logo"
style="width: 100%; max-width: 160px; height: auto; padding: 5px;" />

                            </div>
                            <div class="institute-name">SHELAR TRAINING INSTITUTE</div>
                            <div class="receipt-label">RECEIPT</div>
                        </div>
                        <div class="receipt-content">
                            <div class="receipt-info">
                                <div class="receipt-no">Receipt No: ${receiptData.receiptNo}</div>
                                <div class="date">Date: ${receiptData.date}</div>
                            </div>
                            <div class="form-fields">
                                <div class="field-row">
                                    <div class="field-label">Student Name:</div>
                                    <div class="field-value">${receiptData.studentName}</div>
                                </div>
                                <div class="field-row">
                                    <div class="field-label">Course Name:</div>
                                    <div class="field-value">${receiptData.courseName}</div>
                                </div>
                                <div class="field-row amount-fields">
                                    <div class="amount-field">
                                        <div class="field-row">
                                            <div class="field-label">Total Amount:</div>
                                            <div class="field-value">${receiptData.totalAmount}</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="field-row">
                                    <div class="field-label">Payment Mode:</div>
                                    <div class="field-value">${receiptData.paymentMode}</div>
                                </div>
                                
                                
                            </div>
                            <div class="footer">
                                <div class="note">• Fees once paid are non-refundable</div>
                                <div class="signature-area">
                                    <div class="signature-line"></div>
                                    <div class="signature-label">Authorized Signature</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr style="border: 2px dashed #000; margin: 25px 0;">
                    <!-- Second Receipt (Duplicate) -->
                    <div class="receipt">
                        <div class="header">
                            <div class="logo">
                               <img src="data:image/svg+xml;utf8,
<svg xmlns='http://www.w3.org/2000/svg' width='160' height='160'>
  <circle cx='80' cy='80' r='75' fill='%232c3e50'/>
  <text x='50%' y='55%' font-size='80' font-family='Arial' font-weight='bold' fill='white' text-anchor='middle' dominant-baseline='middle'>S</text>
</svg>"
alt="Logo"
style="width: 100%; max-width: 160px; height: auto; padding: 5px;" />

                            </div>
                            <div class="institute-name">SHELAR TRAINING INSTITUTE</div>
                            <div class="receipt-label">RECEIPT</div>
                        </div>
                        <div class="receipt-content">
                            <div class="receipt-info">
                                <div class="receipt-no">Receipt No: ${receiptData.receiptNo}</div>
                                <div class="date">Date: ${receiptData.date}</div>
                            </div>
                            <div class="form-fields">
                                <div class="field-row">
                                    <div class="field-label">Student Name:</div>
                                    <div class="field-value">${receiptData.studentName}</div>
                                </div>
                                <div class="field-row">
                                    <div class="field-label">Course Name:</div>
                                    <div class="field-value">${receiptData.courseName}</div>
                                </div>
                                <div class="field-row amount-fields">
                                    <div class="amount-field">
                                        <div class="field-row">
                                            <div class="field-label">Total Amount:</div>
                                            <div class="field-value">${receiptData.totalAmount}</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="field-row">
                                    <div class="field-label">Payment Mode:</div>
                                    <div class="field-value">${receiptData.paymentMode}</div>
                                </div>
                                
                                
                            </div>
                            <div class="footer">
                                <div class="note">• Fees once paid are non-refundable</div>
                                <div class="signature-area">
                                    <div class="signature-line"></div>
                                    <div class="signature-label">Authorized Signature</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <script>
                    setTimeout(() => {
                        window.print();
                    }, 500);
                </scr` + `ipt>
            </body>
            </html>
        `;

        // Open a new tab and write the receipt
        const printWindow = window.open('', '_blank', 'width=800,height=1000');
        printWindow.document.write(receiptHTML);
        printWindow.document.close();
        console.log("Student Name from form:", studentName);
        console.log("Course Name from form:", courseName);


    } catch (error) {
        console.error("Error generating receipt:", error);
        alert("Error generating receipt. Please check the console for details.");
    }
}


function loadexamfee(){
  const receiptInput = document.getElementById("ExamReceiptNumber");
    if (!receiptInput) {
      console.error("Receipt number input field not found!");
      return;
    }

    // 1. Reset the input field's state each time the form is opened.
    receiptInput.readOnly = false;
    receiptInput.value = "Generating..."; // Show immediate feedback.

    // 2. Clear any lingering timers from previous times the form was opened.
    clearTimeout(receiptLockTimer);

    // 3. Call the backend script to fetch the number.
    google.script.run
      .withSuccessHandler(function (newReceiptNumber) {
        // 4. Populate the input field as soon as the number is received.
        receiptInput.value = newReceiptNumber;
        console.log(
          `Populated receipt number: ${newReceiptNumber}. Field will lock in 5 seconds if not edited.`
        );

        // 5. Set a 5-second timer. If it completes, the field becomes read-only.
        receiptLockTimer = setTimeout(() => {
          receiptInput.readOnly = true;
          console.log(`Receipt number ${newReceiptNumber} is now locked.`);
        }, 5000); // 5000 milliseconds = 5 seconds

        // 6. Listen for the *very first* input from the user.
        // The { once: true } option automatically removes the listener after it runs once.
        receiptInput.addEventListener(
          "input",
          () => {
            console.log("User is typing. Cancelling the auto-lock timer.");
            // If the user starts typing, cancel the timer that would have locked the field.
            clearTimeout(receiptLockTimer);
          },
          { once: true }
        );
      })
      .withFailureHandler(function (error) {
        console.error("Error fetching receipt number: " + error.message);
        receiptInput.value = "Error fetching number";
      })
      .getNextReceiptNumberEF();
}
</script>
